{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "3GPP Test Case Schema",
  "description": "Schema for 3GPP-compliant test cases with realistic protocol parameters",
  "type": "object",
  "required": [
    "id",
    "title",
    "suite_type",
    "threegpp_ref",
    "description",
    "complexity",
    "expected_duration",
    "default_parameters",
    "steps",
    "expected_results"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9-]+$",
      "description": "Unique identifier for the test case"
    },
    "title": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "description": "Human-readable title of the test case"
    },
    "suite_type": {
      "type": "string",
      "enum": [
        "functional",
        "mobility",
        "performance",
        "security",
        "ims",
        "qos",
        "oran",
        "nbiot",
        "ntn",
        "v2x",
        "interrat",
        "negative",
        "regression"
      ],
      "description": "Category of the test case"
    },
    "threegpp_ref": {
      "type": "string",
      "pattern": "^TS [0-9]+\\.[0-9]+ [0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "3GPP specification reference"
    },
    "description": {
      "type": "string",
      "minLength": 10,
      "maxLength": 500,
      "description": "Detailed description of the test case"
    },
    "complexity": {
      "type": "string",
      "enum": ["basic", "intermediate", "advanced"],
      "description": "Complexity level of the test case"
    },
    "expected_duration": {
      "type": "integer",
      "minimum": 1,
      "maximum": 300,
      "description": "Expected duration in seconds"
    },
    "default_parameters": {
      "type": "object",
      "required": ["ue", "network"],
      "properties": {
        "ue": {
          "type": "object",
          "description": "UE-specific parameters",
          "properties": {
            "imsi": {
              "type": "string",
              "pattern": "^[0-9]{15}$",
              "description": "International Mobile Subscriber Identity"
            },
            "s_tmsi": {
              "type": "string",
              "pattern": "^0x[0-9A-Fa-f]{8}$",
              "description": "Short Temporary Mobile Subscriber Identity"
            },
            "rnti": {
              "type": "integer",
              "minimum": 0,
              "maximum": 65535,
              "description": "Radio Network Temporary Identifier"
            },
            "plmn_id": {
              "type": "string",
              "pattern": "^[0-9]{5}$",
              "description": "Public Land Mobile Network Identifier"
            },
            "tac": {
              "type": "string",
              "pattern": "^[0-9A-Fa-f]{4}$",
              "description": "Tracking Area Code"
            },
            "cell_id": {
              "type": "string",
              "pattern": "^0x[0-9A-Fa-f]{6}$",
              "description": "Cell Identifier"
            }
          }
        },
        "network": {
          "type": "object",
          "description": "Network-specific parameters",
          "properties": {
            "enb_id": {
              "type": "string",
              "pattern": "^eNB-[0-9]{3}$",
              "description": "eNodeB Identifier"
            },
            "gnb_id": {
              "type": "string",
              "pattern": "^gNB-[0-9]{3}$",
              "description": "gNodeB Identifier"
            },
            "mme_id": {
              "type": "string",
              "pattern": "^MME-[0-9]{2}$",
              "description": "MME Identifier"
            },
            "amf_id": {
              "type": "string",
              "pattern": "^AMF-[0-9]{2}$",
              "description": "AMF Identifier"
            },
            "plmn_id": {
              "type": "string",
              "pattern": "^[0-9]{5}$",
              "description": "Public Land Mobile Network Identifier"
            },
            "tac": {
              "type": "string",
              "pattern": "^[0-9A-Fa-f]{4}$",
              "description": "Tracking Area Code"
            },
            "cell_id": {
              "type": "string",
              "pattern": "^0x[0-9A-Fa-f]{6}$",
              "description": "Cell Identifier"
            }
          }
        }
      }
    },
    "steps": {
      "type": "array",
      "minItems": 1,
      "maxItems": 50,
      "items": {
        "type": "object",
        "required": [
          "order",
          "layer",
          "direction",
          "message_type",
          "message_json",
          "expected_params",
          "correlation_keys"
        ],
        "properties": {
          "order": {
            "type": "integer",
            "minimum": 1,
            "description": "Step order in the test case"
          },
          "layer": {
            "type": "string",
            "enum": [
              "RRC",
              "NAS",
              "S1AP",
              "NGAP",
              "SIP",
              "Diameter",
              "F1AP",
              "E1AP",
              "E2AP",
              "GTP-U",
              "PC5",
              "Uu"
            ],
            "description": "Protocol layer"
          },
          "direction": {
            "type": "string",
            "pattern": "^(UE→|→UE|eNB→|→eNB|gNB→|→gNB|MME→|→MME|AMF→|→AMF|Core→|→Core|IMS→|→IMS|UE→UE)$",
            "description": "Message direction"
          },
          "message_type": {
            "type": "string",
            "minLength": 1,
            "maxLength": 50,
            "description": "Type of protocol message"
          },
          "message_json": {
            "type": "object",
            "description": "Complete message structure as per 3GPP specification"
          },
          "expected_params": {
            "type": "object",
            "description": "Expected parameters in the message"
          },
          "correlation_keys": {
            "type": "object",
            "description": "Keys for message correlation (RNTI, PLMN, TAC, etc.)"
          }
        }
      }
    },
    "expected_results": {
      "type": "object",
      "required": [
        "total_duration",
        "message_count"
      ],
      "properties": {
        "total_duration": {
          "type": "string",
          "pattern": "^[0-9]+s$",
          "description": "Expected total duration"
        },
        "message_count": {
          "type": "integer",
          "minimum": 1,
          "description": "Expected number of messages"
        }
      },
      "additionalProperties": {
        "type": "boolean",
        "description": "Additional expected results"
      }
    }
  },
  "additionalProperties": false
}